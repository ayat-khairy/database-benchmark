Match (e:SensorReading)-[r:`has provenance`]-> (s:SensorReadingProvenance)  where  s.sensorType STARTS WITH 'ELec'  AND s.readingsLocation IN ["GW", "GW32", "FW", "FW29" , "SW", "SW00"] AND e.date="1/11/2016" return SUM( e.reading)
Match (e:SensorReading)-[r:`has provenance`]-> (s:SensorReadingProvenance) where  s.sensorType ='CO2'  with e.date as date , SUM (e.reading) as accR with  date as maxCO2Date, accR order by accR DESC limit 1 Match (e2:SensorReading)-[r:`has provenance`]-> (s2:SensorReadingProvenance) where  s2.sensorType STARTS WITH 'ELec'  AND e2.date = maxCO2Date return  maxCO2Date, avg(e2.reading)
Match (e:SensorReading)-[r:`has provenance`]-> (S:SensorReadingProvenance) where  S.sensorType IN ["ELec-Sockets" , "ELec-Sockets and power"]  return S.readingsLocation, SUM( e.reading) as acc  order by   acc DESC limit 1
Match (e:SensorReading)-[r:`has provenance`]-> (s:SensorReadingProvenance) where  s.sensorType STARTS WITH 'Temp'  with e.date as dates, avg(e.reading)as avgTemp where avgTemp>25 with collect ( dates) as dates Match (e2:SensorReading)-[r:`has provenance`]-> (s2:SensorReadingProvenance) where  s2.sensorType="ELec-Lighting"   AND e2.date IN dates return sum (e2.reading), e2.date
Match (e:SensorReading)-[r:`has provenance`]-> (s:SensorReadingProvenance) where  s.sensorType STARTS WITH 'ELec'   AND e.hour IN RANGE (19,24) return s.readingsLocation, AVG(e.reading ) as avg order by   avg DESC limit 1
