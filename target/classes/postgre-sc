select avg (reading) , day from aq_reading , zone, station where sensortype= 'CO' AND aq_reading.stationid = station.stationid AND station.zoneid = zone.id AND zone.zone_name='huntingdon_road' group by day;
select avg (reading) as avg ,day, zone.zone_name from aq_reading , zone, station where sensortype= 'CO' AND aq_reading.stationid = station.stationid AND station.zoneid = zone.id  group by day, zone.zone_name order by avg DESC limit 1 ;
select avg (reading), day from aq_reading , zone, station where sensortype= 'CO' AND aq_reading.stationid = station.stationid AND station.zoneid = zone.id AND zone.zone_name='trumpington_road' AND aq_reading.day in (26,27)  group by day;
select avg (reading), day from aq_reading , zone, station where sensortype= 'CO' AND aq_reading.stationid = station.stationid AND station.zoneid = zone.id AND aq_reading.hour >8 AND aq_reading.hour<11  group by day;
select avg (reading), day from aq_reading , zone, station where sensortype= 'CO' AND aq_reading.stationid = station.stationid AND station.zoneid = zone.id AND zone.zone_name='trumpington_road' AND aq_reading.hour >8 AND aq_reading.hour<11  group by day;
with record AS ( select hour,count (*) as total from buspos ,  zone where zone.zone_name='trumpington_road' AND buspos.day  = 1 AND ST_Distance(position , zonepos)<2000  group by hour  order by  total DESC limit 1 ) select record.hour, avg (reading) from aq_reading , zone, station, record  where sensortype= 'CO' AND aq_reading.stationid = station.stationid AND station.zoneid = zone.id AND zone.zone_name='trumpington_road'  AND aq_reading.hour =record.hour GROUP BY record.hour ;
select avg (reading) as avg , zone.zone_name from aq_reading , zone, station where sensortype= 'CO' AND aq_reading.stationid = station.stationid AND station.zoneid = zone.id  AND aq_reading.hour > 19 group by zone.zone_name order by avg DESC limit 1 ;
with record AS (select hour, avg ( carparking.spaces_occupied) from carparking , parkingplaces , zone where carparking.parking_id = parkingplaces.parking_id  AND zone.zone_name='trumpington_road' AND ST_DWithin(position , zonepos, 2000)  group by hour ,  carparking.spaces_occupied order by  carparking.spaces_occupied DESC limit 1 ) select record.hour , avg (reading) from aq_reading , zone, station, record  where sensortype= 'CO' AND aq_reading.stationid = station.stationid AND station.zoneid = zone.id AND zone.zone_name='trumpington_road'  AND aq_reading.hour =record.hour group by record.hour  ;
select count (*) as total from buspos ,  zone where zone.zone_name='trumpington_road' AND buspos.day  = 1 AND ST_Distance(position , zonepos)<2000  ;
