match (r:aq_reading)-[:MADE_BY]->(s:station)-[:LOCATED_IN]->(z:zone) where r.sensortype='CO' AND z.zone_name ='huntingdon_road'  return avg(r.reading) , r.day  order by r.day ASC;
match (r:aq_reading)-[:MADE_BY]->(s:station)-[:LOCATED_IN]->(z:zone) using index r:aq_reading(sensortype) where r.sensortype= 'CO' return avg(r.reading) as AvgCO, r.day  , z.zone_name order by  AvgCO DESC limit 1 ;
match (r:aq_reading)-[:MADE_BY]->(s:station)-[:LOCATED_IN]->(z:zone) using index r:aq_reading(day)  using index z:zone(zone_name) where r.sensortype = 'CO' AND z.zone_name='trumpington_road' AND r.day in range (26,27)    return avg(r.reading) as AvgCO, r.day  , z.zone_name order by  AvgCO ;
match (r:aq_reading)-[:MADE_BY]->(s:station)-[:LOCATED_IN]->(z:zone)  using index r:aq_reading(hour) where r.sensortype = 'CO' AND  r.hour IN RANGE (8,11)   return avg(r.reading) as AvgCO , r.day order by  r.day ASC ;
match (r:aq_reading)-[:MADE_BY]->(s:station)-[:LOCATED_IN]->(z:zone) using index  z:zone(zone_name)  using index r:aq_reading(hour) where r.sensortype = 'CO' AND  r.hour IN RANGE (8,11) AND z.zone_name='trumpington_road'   return avg(r.reading) as AvgCO , r.day order by  r.day ASC ;
match (b:buspos) where b.day=1 with b match (z:zone) where z.zone_name="trumpington_road" AND toInt(distance(point(b),point(z))) < 2000 with count(b) as total , b.hour as maxHour order by total DESC limit 1 match (r:aq_reading)-[:MADE_BY]->(s:station)-[:LOCATED_IN]->(z:zone) using index r:aq_reading(hour) where r.sensortype='CO'   AND z.zone_name='trumpington_road'  AND r.hour =maxHour  return avg(r.reading)as AvgCO order by  AvgCO ;
match (r:aq_reading)-[:MADE_BY]->(s:station)-[:LOCATED_IN]->(z:zone) using index r:aq_reading(sensortype) where r.sensortype='CO' AND r.hour > 19  return avg(r.reading) as AvgCO, r.day  , z.zone_name order by  AvgCO DESC limit 1 ;
match (c:carparking)-[:LOCATED_IN]->(p:parkingplaces) with c, p match (z:zone) where z.zone_name='trumpington_road' AND  toInt(distance(point(p),point(z))) < 2000  with  c.hour as maxHour order by  c.spaces_occupied DESC limit 1 match (r:aq_reading)-[:MADE_BY]->(s:station)-[:LOCATED_IN]->(z:zone) using index r:aq_reading(hour) where r.sensortype='CO'   AND z.zone_name='trumpington_road'  AND r.hour =maxHour  return avg(r.reading)as AvgCO order by  AvgCO ;
match (b:buspos) where b.day=1 with b match (z:zone) where z.zone_name="trumpington_road" AND toInt(distance(point(b),point(z))) < 2000 return count(b) as total
